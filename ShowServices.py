#!/usr/bin/python3

import subprocess
import os
import sys
from prettytable import from_csv

def show_services():
    try:
        host=input("Enter host IP: ")
        filename=input("Enter filename for processing output: ")
        xml_file = open (filename, "w+")
        subprocess.call(["nmap", "-sV", host, "-oX", filename])
        xml_file.close()
        xml_file = open (filename, "r")
        subprocess.call(["python3", "nmap_xml_parser.py",  "-f", filename, "-csv", filename + ".csv"])
        xml_file.close()  
        prettytable_csv_input = filename + ".csv"
        print (prettytable_csv_input)
        fp = open(prettytable_csv_input, "r")
        services_table = from_csv (fp)
        fp.close()
        print(services_table)
        
    except KeyboardInterrupt:
        sys.exit(1)   
        
if __name__ == '__main__': 
    show_services()
