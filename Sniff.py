#!/usr/bin/python3

import pyshark
import sys

def sniffing():
    try:
        interface1 = input("Enter network interface to be used for capture (e.g. en0, eth0, lo0): ")
        path = input("Enter system path to save the file (e.g. /root/Documents/capture.pcap): ")
        loop = True
        while loop:
            choice = input("Choose sniffing mode - 1 for number of packets or 2 for timeout interval: ")
            if int(choice) == 1:
                num_packets=input("Number of packets: ")
                cap = pyshark.LiveCapture(interface=interface1, output_file=path)
                cap.sniff(packet_count=int(num_packets))
                print("Capture saved to " + str(path))
                loop=False
            elif int(choice) == 2:
                timeout_interval=input("Timeout interval: ")
                cap = pyshark.LiveCapture(interface=interface1, output_file=path)
                cap.sniff(timeout=int(timeout_interval))
                print("Capture saved to " + str(path))
                loop=False
            else:
                print("Invalid option, please try again.")
                        
    except KeyboardInterrupt:
        sys.exit(1)
        
if __name__ == '__main__':        
    sniffing()
